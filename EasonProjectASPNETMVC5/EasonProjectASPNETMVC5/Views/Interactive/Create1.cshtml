@model EasonProjectASPNETMVC5.Models.StudentTable

@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Create1</title>
</head>
<body>
    @Scripts.Render("~/bundles/jquery")
    @Scripts.Render("~/bundles/jqueryval")
    <script type="text/javascript">
        //上方，第一號下拉式選單，名為 DepartmentId
        //下方，第二號下拉式選單，名為 UserId  (以傳統HTML表單的寫法來做，<select>)
        $(document).ready(function () {
            $('#DepartmentID').change(function () {
            // 第一號下拉式選單若被點選，第二號就重新填入新的「子選項」。

            var userSelectId = $.trim($('#DepartmentID option:selected').val());
            $('#StudentID').empty();  // 清空第二號 下拉式選單

            if (userSelectId.length == 0) {
                $('#StudentID').append($('<option></option>').val('').text('-= 請選擇 =-'));
            }
            else {
                $.ajax( {    // jQuery AJAX 參考資料 http://api.jquery.com/jquery.ajax/
                        url: "@Url.Content("~/Interactive/GetStudentList")",   // 記得 URL網址 前後用雙引號（"）包起來
                        data: { id: userSelectId },  // 傳給上面URL網址的數值
                        type: 'post',
                        cache: false,
                        async: false,
                        dataType: 'html',   // 可改成 text
                    success: function (data) {
                            if (data.length > 0) {
                                //*******************************************
                                // 如果有傳回資料，就把資料 <option>放入 第二號下拉式選單底下，當成子選項。
                                $('#StudentID').append(data);
                                //*******************************************
                        }   },   // success end
                        error: function () {
                            alert('例外狀況，AJAX有問題～～');
                            // AJAX Error 請看 https://stackoverflow.com/questions/12734714/jquery-ajax-error-handling-http-status-codes
                        }   // error end
                    });   // ajax end
            }  // if end

            });  // .change() end
        });
    </script>
    請選擇DepratmentID：
    <!-- **************************************************************************************** -->
    @Html.DropDownList("DepartmentID", ViewBag.DepartmentList as SelectList, "-= 請選擇 =-", new { @class = "form-control" })
    <!-- 透過 ViewBag傳過來，所以檢視畫面的第一列，不需搭配任何 model -->

    <br /><br />該科系的學員（傳統HTML的下拉式選單 - [select]寫法）：
    @*  Html.DropDownList("UserId", ViewBag.UtListItem as SelectList)  *@
    <select id="StudentID" name="StudentID"></select>

</body>
</html>
